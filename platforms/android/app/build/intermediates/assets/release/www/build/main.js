webpackJsonp([0],{161:function(t,e,n){"use strict";n.d(e,"a",function(){return s});var o=n(37),i=n(0),r=this&&this.__decorate||function(t,e,n,o){var i,r=arguments.length,a=r<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(a=(r<3?i(a):r>3?i(e,n,a):i(e,n))||a);return r>3&&a&&Object.defineProperty(e,n,a),a},a=this&&this.__metadata||function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},s=function(){function t(t){this.http=t,this.matchingTraders=[],this.loading=!1}return t.prototype.getNearestPossibleTrades=function(t){var e=this;console.log("provider getNPT: "+t);var n=(new o.c).set("key","eJQ0S7PjPs9BJJEJY8fXaJTNrngJIko4"),i="https://lemon-data-center-js.herokuapp.com/api/getNPT?key="+t;this.loading=!0;var r=this.http.get(i,{headers:n}).subscribe(function(t){e.matchingTraders=t,console.log("get getNearestPossibleTrades: ",e.matchingTraders),e.loading=!1,r.unsubscribe()})},t=r([Object(i.A)(),a("design:paramtypes",[o.a])],t)}()},162:function(t,e,n){"use strict";n.d(e,"a",function(){return u});var o=n(0),i=n(23),r=n(48),a=n(72),s=n(47),c=this&&this.__decorate||function(t,e,n,o){var i,r=arguments.length,a=r<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(a=(r<3?i(a):r>3?i(e,n,a):i(e,n))||a);return r>3&&a&&Object.defineProperty(e,n,a),a},l=this&&this.__metadata||function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},u=function(){function t(t,e,n,o,i){var r=this;this.navCtrl=t,this.navParams=e,this.profile=n,this.fbApp=o,this.auth=i,this.message="",this.thread=[],this.threads=[],this.trader=e.get("trader"),console.log("[chat] trader: ",this.trader),this.converKey=this.fbApp.getTraderConversationKey(this.trader,this.profile.user),this.converKey&&(this.chatSub=this.fbApp.getConversationMessages(this.converKey).subscribe(function(t){console.log("thread ",t),r.thread=t,r.threads[r.trader.key]=t}))}return t.prototype.ionViewDidLoad=function(){},t.prototype.ionViewWillEnter=function(){},t.prototype.ionViewDidLeave=function(){this.chatSub&&(console.log("ONLEAVE CHAT PAGE"),this.chatSub.unsubscribe())},t.prototype.send=function(){var t=this;console.log("sent message: ",this.message),this.converKey?(console.log("UPDATE CHAT "+this.converKey),this.fbApp.updateConversation(this.converKey,this.trader,this.profile.user,this.message)):(this.converKey=this.fbApp.createNewThread(this.trader,this.profile.user,this.message).key,console.log("PUSH CHAT "+this.converKey),this.chatSub=this.fbApp.getConversationMessages(this.converKey).subscribe(function(e){console.log("thread ",e),t.thread=e})),this.message=""},t=c([Object(o.m)({selector:"page-chat",template:'\x3c!--\n  Generated template for the ChatPage page.\n\n  See http://ionicframework.com/docs/components/#navigation for more info on\n  Ionic pages and navigation.\n--\x3e\n<ion-header class="ps4-header">\n\n  <ion-navbar>\n    <ion-title>{{trader.first_name + " " + trader.last_name}}</ion-title>\n  </ion-navbar>\n</ion-header>\n<ion-icon style="color: #fff;" name="menu" menuToggle class="menu-toggle-forced"></ion-icon>\n<ion-content class="ps4" padding>\n\n\t<div class="thread">\n\t\t<div class="chat-message" [ngClass]="{\'trader-message\': message.senderKey !== profile.user.key}" *ngFor="let message of thread">\n\t\t\t<h5>{{message.text}}</h5>\n\t\t</div>\n\t</div>\n\n\t<div class="ps4-message-input message-input">\n\t\t\t<ion-input [(ngModel)]="message" placeholder="Type a message..." (keyup.enter)="send()">\n\t\t\t</ion-input>\n\t\t\t<button (click)="send()">Send</button>\n\t</div>\n</ion-content>\n\n\n<ion-nav #mycontent [root]="rootPage">\n</ion-nav>\n\n<ion-menu class="chat-menu" side="right" [content]="mycontent">\n  <ion-content>\n  \t<ion-header>\n  \t\tPreferred Trading Locations\n  \t</ion-header>\n  \t<ion-list>\n  \t\t<ion-item *ngFor="let tradeLocation of trader.trade_locations">\n  \t\t\t{{tradeLocation}}\n  \t\t</ion-item>\n  \t</ion-list>\n\n \t\t<div class="trade-grid">\n\t \t\t<div class="trade-item" *ngFor="let item of trader.matchingTrades">\n\t \t\t\t<img-loader class="fit-img" src="{{item.cover_url | replace: \'cover_big\':\'thumb\'}}"></img-loader>\n\t \t\t</div>\n \t\t</div>\n \t\t\n  </ion-content>\n</ion-menu>'}),l("design:paramtypes",[i.e,i.f,r.a,a.a,s.a])],t)}()},197:function(t,e){function n(t){return Promise.resolve().then(function(){throw new Error("Cannot find module '"+t+"'.")})}n.keys=function(){return[]},n.resolve=n,t.exports=n,n.id=197},240:function(t,e){function n(t){return Promise.resolve().then(function(){throw new Error("Cannot find module '"+t+"'.")})}n.keys=function(){return[]},n.resolve=n,t.exports=n,n.id=240},288:function(t,e,n){"use strict";n.d(e,"a",function(){return o});var o=function(){return function(){this.profileImage="",this.name="",this.first_name="",this.last_name="",this.email="",this.key="",this.wishList=[],this.ownedList=[],this.consoles=[],this.trade_locations=[],this.last_location={}}}()},296:function(t,e,n){"use strict";n.d(e,"a",function(){return u});var o=n(0),i=n(23),r=n(48),a=n(161),s=n(162),c=this&&this.__decorate||function(t,e,n,o){var i,r=arguments.length,a=r<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(a=(r<3?i(a):r>3?i(e,n,a):i(e,n))||a);return r>3&&a&&Object.defineProperty(e,n,a),a},l=this&&this.__metadata||function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},u=function(){function t(t,e,n,o,i){this.navCtrl=t,this.platform=e,this.trade=n,this.profile=o,this.app=i}return t.prototype.ionViewDidLoad=function(){},t.prototype.getNearestPossibleTrades=function(){console.log("getNearestPossibleTrades"),this.trade.getNearestPossibleTrades(this.profile.user.key)},t.prototype.showChat=function(t){this.app.getRootNavs()[0].push(s.a,{trader:t})},t=c([Object(o.m)({selector:"page-trade",template:'<ion-content class="ps4">\n\x3c!-- <div style="height: 100%;" (click)="getNearestPossibleTrades()">\n\t\n</div> --\x3e\n\t<ion-spinner *ngIf="trade.loading" name="bubbles"></ion-spinner>\n\n\t<h4  style="padding: 5px 5px 0 16px;">Matches found</h4>\n \t<ion-item class="matching-trades" *ngFor="let trader of trade.matchingTraders" no-lines>\n \t\t<div class="info-row">\n\t \t\t<h5>{{trader.first_name + " " + trader.last_name}} is offering</h5>\n \t\t</div>\n \t\t<div class="trade-grid">\n\t \t\t<div class="trade-item" *ngFor="let item of trader.matchingTrades">\n\t \t\t\t<img-loader class="fit-img" src="{{item.cover_url | replace: \'cover_big\':\'thumb\'}}"></img-loader>\n\t \t\t</div>\n \t\t</div>\n \t\t<div class="info-row">\n\t \t\t<h5>{{trader.first_name + " " + trader.last_name}} is interested in</h5>\n \t\t</div>\n \t\t<div class="trade-grid ">\n\t \t\t<div class="trade-item" *ngFor="let item of trader.matchingWishes">\n\t \t\t\t<img-loader class="fit-img" src="{{item.cover_url | replace: \'cover_big\':\'thumb\'}}"></img-loader>\n\t \t\t</div>\n \t\t</div>\n \t\t<div class="info-row">\n\t \t\t<h5 class="info-matches">{{trader.matchingTrades.length}} matches</h5>\n \t\t\t<h5>{{trader.distance | ceil}} miles away</h5>\n \t\t\t<ion-icon style="color: #fff;" name="chatbubbles" (click)="showChat(trader)"></ion-icon>\n \t\t</div>\n \t</ion-item>\n</ion-content>'}),l("design:paramtypes",[i.e,i.g,a.a,r.a,i.a])],t)}()},297:function(t,e,n){"use strict";n.d(e,"a",function(){return u});var o=n(0),i=n(23),r=n(48),a=n(72),s=n(162),c=this&&this.__decorate||function(t,e,n,o){var i,r=arguments.length,a=r<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(a=(r<3?i(a):r>3?i(e,n,a):i(e,n))||a);return r>3&&a&&Object.defineProperty(e,n,a),a},l=this&&this.__metadata||function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},u=function(){function t(t,e,n,o){var i=this;this.navCtrl=t,this.profile=e,this.fbApp=n,this.app=o,this.traders=[],this.fbApp.getUserConversations(e.user).subscribe(function(t){if(t){for(var e in t.payload.val()){var n=t.payload.val()[e];i.fbApp.getProfile(n.traderKey).then(function(t){null!=t.profileImage&&""!=t.profileImage||(t.profileImage=i.getRandomPic()),i.traders.push(t)})}console.log("conversations: ",i.traders)}})}return t.prototype.showChat=function(t){this.app.getRootNavs()[0].push(s.a,{trader:t})},t.prototype.getRandomPic=function(){return"assets/imgs/temp_profile_img_"+this.getRandomInt(1,2)+".png"},t.prototype.getRandomInt=function(t,e){return Math.floor(Math.random()*(e-t+1))+t},t=c([Object(o.m)({selector:"page-messages",template:'<ion-content class="ps4">\n    <ion-item *ngFor="let trader of traders" (click)="showChat(trader)" no-lines>\n        <div class="message-container">\n            <div class="trader-img-container">\n                <img class="fit-img" src="{{trader.profileImage}}"> \n            </div>\n            <div class="trader-info">\n                <h5 class="trader-name">{{trader.first_name + " " + trader.last_name}} </h5>\n            </div>\n       \n        </div>\n\x3c!--         <div class="message-container">\n            <div class="trader-info">\n                <h5 class="trader-name">{{trader.first_name + " " + trader.last_name}} </h5>\n            </div>\n            <div class="matches">\n                <div class="trade-item"  *ngFor="let item of trader.ownedList">\n                    <ng-container *ngIf="profile.isItemMatch(item)">\n                        <h5>{{item.name}}</h5>\n                    </ng-container>\n                </div>\n            </div>\n        </div> --\x3e\n    </ion-item>\n</ion-content>\n'}),l("design:paramtypes",[i.e,r.a,a.a,i.a])],t)}()},298:function(t,e,n){"use strict";n.d(e,"a",function(){return h});var o=n(0),i=n(23),r=n(47),a=n(48),s=n(299),c=n(510),l=n(300),u=n(301),d=n(304),f=this&&this.__decorate||function(t,e,n,o){var i,r=arguments.length,a=r<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(a=(r<3?i(a):r>3?i(e,n,a):i(e,n))||a);return r>3&&a&&Object.defineProperty(e,n,a),a},p=this&&this.__metadata||function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},h=function(){function t(t,e,n,o,i,r){this.navCtrl=t,this.igdb=e,this.auth=n,this.profile=o,this.imgLoader=i,this.app=r,this.searchIsLoading=!1,this.searchOptions=[],i.setBackgroundSize("cover")}return t.prototype.toggleItemOwnership=function(t,e){this.profile.toggleItemOwnership(this.auth.user,t,e)},t.prototype.toggleItemPlatform=function(t,e,n){this.profile.toggleItemPlatform(this.auth.user,t,e,n)},t.prototype.removeItem=function(t,e){console.log("pressing"),this.profile.removeItem(this.auth.user,t,e)},t.prototype.searchtTitle=function(){var t=this;this.searchIsLoading=!0,clearTimeout(this.timeout),this.timeout=setTimeout(function(){!t.searchInput||t.searchInput.length<2?t.clearSearch():t.igdb.search(t.searchInput).then(function(e){t.searchOptions=e,0==e.length&&t.searchOptions.push({id:"err",name:"No Games Found"}),t.searchIsLoading=!1})},300)},t.prototype.clearSearch=function(){this.searchIsLoading=!1,this.searchOptions=[]},t.prototype.addGameToProfile=function(t){if("err"!==t.id){var e=[""];t.platforms&&(t.platforms.includes(l.a.PS4_ID)&&e.push("ps4"),t.platforms.includes(l.a.NS_ID)&&e.push("nintendo_switch"),t.platforms.includes(l.a.XBOX1_ID)&&e.push("xbox1"));var n=null;t.cover&&(n=t.cover.url.replace("thumb","cover_big").replace("//","http://"));var o=new c.a(t.id,t.name,n,e);this.profile.addGameToProfile(this.auth.user,o,!1),this.searchInput=null,this.searchOptions=[]}},t.prototype.navToMap=function(){this.app.getRootNavs()[0].push(d.a)},t=f([Object(o.m)({selector:"page-profile",template:'<ion-content class="ps4" (click)="clearSearch()">\n\n\n\n<div class="profile">\n\n  <div class="profile-image">\n\n    <img-loader class="circle-head" src="{{profile.user.profileImage}}"></img-loader>\n\n  </div>\n\n  <div class="profile-info-wrapper">\n\n    <div class="profile-info">\n\n        <h4>{{profile.user.name}}</h4>\n\n        \x3c!-- <ion-icon name="create"></ion-icon> --\x3e\n\n      \x3c!-- <h5>{{profile.user.location}}</h5> --\x3e\n\n    </div>\n\n  </div>\n\n  <button class="set-location-btn" ion-button (click)="navToMap()">\n\n    Set Trade Locations\n\n  </button>\n\n</div>\n\n\n\n<hr inset padding-horizontal style="background-color: #fff;">\n\n\n\n<div class="trade-info" >\n\n  \n\n  <div class="game-input-wrapper">\n\n    <ion-spinner *ngIf="searchIsLoading" class="search-spinner" name="dots"></ion-spinner>        \n\n    <ion-item  inset class="game-input" no-lines>\n\n      <ion-input (ionChange)="searchtTitle()" type="text" [(ngModel)]="searchInput" placeholder="Add a game">\n\n      </ion-input>\n\n    </ion-item>\n\n    <h5 float-right class="tip-text">*tap games to toggle, hold to delete</h5>\n\n    <div class="autocomplete">\n\n      <ion-list>\n\n        <ion-item class="autocomplete-item" *ngFor="let item of searchOptions" (click)="addGameToProfile(item)">\n\n          \x3c!-- <img *ngIf="item.cover != null" src="{{item.cover.url}}"> --\x3e\n\n          <h5>{{item.name}}</h5>\n\n        </ion-item>\n\n      </ion-list>\n\n    </div>\n\n  </div>\n\n  \n\n  <h5 class="divider" style="padding-top: 30px;">Looking for</h5>\n\n\n\n  <div class="display-grid">\n\n    <div class="trade-item" *ngFor="let item of profile.user.wishList">\n\n      <div ion-long-press class="trade-img" (tap)="toggleItemOwnership(item, false)" [interval]="400" (onPressing)="removeItem(item, false)">\n\n        <img-loader *ngIf="item.cover_url" class="fit-img" src="{{item.cover_url}}" ></img-loader>\n\n        <img *ngIf="!item.cover_url" class="fit-img" >\n\n        <h5 *ngIf="!item.cover_url" class="trade-img-title" >{{item.name}}</h5>\n\n      </div>\n\n      <div class="platforms">\n\n        <img (tap)="toggleItemPlatform(item, \'xbox1\', false)" [ngClass]="{\'faded\': item.platforms.indexOf(\'xbox1\') == -1}" src="assets/imgs/xbox_icon.png">\n\n        <img (tap)="toggleItemPlatform(item, \'ps4\', false)" [ngClass]="{\'faded\': item.platforms.indexOf(\'ps4\') == -1}" src="assets/imgs/ps4_icon.png">\n\n        <img (tap)="toggleItemPlatform(item, \'nintendo_switch\', false)" [ngClass]="{\'faded\': item.platforms.indexOf(\'nintendo_switch\') == -1}" src="assets/imgs/ns_icon.png">\n\n      </div>\n\n    </div>    \n\n  </div>\n\n\n\n  <h5 class="divider">Owned</h5>\n\n  \n\n  <div class="display-grid">\n\n    <div class="trade-item" *ngFor="let item of profile.user.ownedList">\n\n      <div ion-long-press class="trade-img" (tap)="toggleItemOwnership(item, true)" [interval]="400" (onPressing)="removeItem(item, true)">\n\n        <img-loader *ngIf="item.cover_url" class="fit-img" src="{{item.cover_url}}" ></img-loader>\n\n        <img *ngIf="!item.cover_url" class="fit-img" >\n\n        <h5 *ngIf="!item.cover_url" class="trade-img-title" >{{item.name}}</h5>\n\n      </div>\n\n      <div class="platforms">\n\n        <img (tap)="toggleItemPlatform(item, \'xbox1\', true)" [ngClass]="{\'faded\': item.platforms.indexOf(\'xbox1\') == -1}" src="assets/imgs/xbox_icon.png">\n\n        <img (tap)="toggleItemPlatform(item, \'ps4\', true)" [ngClass]="{\'faded\': item.platforms.indexOf(\'ps4\') == -1}" src="assets/imgs/ps4_icon.png">\n\n        <img (tap)="toggleItemPlatform(item, \'nintendo_switch\', true)" [ngClass]="{\'faded\': item.platforms.indexOf(\'nintendo_switch\') == -1}" src="assets/imgs/ns_icon.png">\n\n      </div>\n\n      \n\n    </div>    \n\n  </div>\n\n</div>\n\n\n\n\n\n</ion-content>\n\n\n\n'}),p("design:paramtypes",[i.e,s.a,r.a,a.a,u.a,i.a])],t)}()},299:function(t,e,n){"use strict";n.d(e,"a",function(){return s});var o=n(37),i=n(0),r=this&&this.__decorate||function(t,e,n,o){var i,r=arguments.length,a=r<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(a=(r<3?i(a):r>3?i(e,n,a):i(e,n))||a);return r>3&&a&&Object.defineProperty(e,n,a),a},a=this&&this.__metadata||function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},s=function(){function t(t){this.http=t,this.searchOptions=[]}return t.prototype.search=function(t){for(var e=this,n=(new o.c).set("user-key","5227ae6e46cee2806cf25779d4c97966").set("Accept","application/json"),i="0",r=[41,6,9,12,48,49,130],a=1;a<164;a++)r.indexOf(a)>-1||(i+=","+a);var s="https://api-endpoint.igdb.com/games/?search="+t+"&filter[release_dates.platform][not_in]="+i+"&filter[category][eq]=0&filter[release_dates.platform][exists]&filter[version_parent][not_exists]&fields=*";return new Promise(function(t,o){var i=e.http.get(s,{headers:n}).subscribe(function(n){var o="";console.log("[igdb] search raw: ",n);for(var r=!0,a=0,s=n;a<s.length;a++){var c=s[a];o+=r?c.id:","+c.id,r=!1}var l=e.removeUnsupportedPlatforms(n);console.log("[igdb] search clean: ",l),t(l),i.unsubscribe()})})},t.prototype.removeUnsupportedPlatforms=function(t){return t.filter(function(t){if(t.platforms)return-1!=t.platforms.indexOf(48)||-1!=t.platforms.indexOf(49)||-1!=t.platforms.indexOf(139)})},t=r([Object(i.A)(),a("design:paramtypes",[o.a])],t)}()},300:function(t,e,n){"use strict";n.d(e,"b",function(){return o}),n.d(e,"a",function(){return i});var o={web:{apiKey:"AIzaSyCs8fw6B3hdkNBkf9o48V_0sTGhxC1Pg_E",authDomain:"console-trade.firebaseapp.com",databaseURL:"https://console-trade.firebaseio.com",projectId:"console-trade",storageBucket:"console-trade.appspot.com",messagingSenderId:"670922071182"}},i={PS4:"ps4",XBOX1:"xbox1",NS:"nintendo_switch",PS4_ID:48,NS_ID:130,XBOX1_ID:49}},304:function(t,e,n){"use strict";n.d(e,"a",function(){return u});var o=n(0),i=n(23),r=n(48),a=n(94),s=n(72),c=this&&this.__decorate||function(t,e,n,o){var i,r=arguments.length,a=r<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(a=(r<3?i(a):r>3?i(e,n,a):i(e,n))||a);return r>3&&a&&Object.defineProperty(e,n,a),a},l=this&&this.__metadata||function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},u=function(){function t(t,e,n,o,i,r){this.navCtrl=t,this.navParams=e,this.platform=n,this.geolocation=o,this.profile=i,this.fbApp=r,this.markers=[],this.searchInput="",this.sessionToken=new google.maps.places.AutocompleteSessionToken}return t.prototype.ionViewDidLoad=function(){},t.prototype.ionViewWillEnter=function(){var t=this;this.platform.ready().then(function(){google&&(t.geocoder=new google.maps.Geocoder,t.places=new google.maps.places.AutocompleteService,t.initMap())})},t.prototype.searchLocation=function(){var t=this;console.log("searchLocation: "+this.searchInput),clearTimeout(this.timeout),this.timeout=setTimeout(function(){t.places.getPlacePredictions({input:t.searchInput,sessionToken:t.sessionToken},function(t){console.log("place prediction ",t)})},500)},t.prototype.initMap=function(){var t=this,e=this;this.geolocation.getCurrentPosition().then(function(n){var o=new google.maps.LatLng(n.coords.latitude,n.coords.longitude);t.map=new google.maps.Map(t.mapElement.nativeElement,{zoom:15,disableDefaultUI:!0,center:o}),t.addMarker(o,{label:"YOU",remember:!1}),t.initAutoComplete(n),t.initClickEvent();for(var i=0,r=t.profile.user.trade_locations;i<r.length;i++){t.geocoder.geocode({address:r[i]},function(t,n){"OK"===n?e.addMarker(t[0].geometry.location):console.log("Geocode was not successful for the following reason: "+n)})}}).catch(function(t){console.log("errrr",t)})},t.prototype.initAutoComplete=function(t){var e=new google.maps.LatLng(t.coords.latitude,t.coords.longitude),n=document.getElementById("autocomplete");this.map.controls[google.maps.ControlPosition.TOP_LEFT].push(n);var o=new google.maps.Circle({center:e,radius:t.coords.accuracy});this.places=new google.maps.places.PlacesService(this.map);var i=this;new google.maps.places.Autocomplete(n,{bounds:o.getBounds(),stritctBounds:!0}).addListener("place_changed",function(){var t=this.getPlace();t&&(console.log("place",t),t.geometry&&(i.map.panTo(t.geometry.location),i.map.setZoom(15),i.addMarker(t.geometry.location),i.addTradeLocation(t.formatted_address)))})},t.prototype.initClickEvent=function(){var t=this;this.map.addListener("click",function(e){e.latLng.lat(),e.latLng.lng();t.geocoder.geocode({location:e.latLng},function(n){console.log("click ",n),n&&(t.addMarker(e.latLng),t.addTradeLocation(n[0].formatted_address))})})},t.prototype.addTradeLocation=function(t){var e=this;clearTimeout(this.dbTimeout),this.profile.user.trade_locations.push(t),this.profile.user.trade_locations.length>3&&this.removeLastTradeLocation(),console.log("[map] addTradeLocation ",this.profile.user),this.dbTimeout=setTimeout(function(){e.fbApp.updateUserTradeLocations(e.profile.user.key,e.profile.user.trade_locations)},500)},t.prototype.removeLastTradeLocation=function(){this.profile.user.trade_locations.shift();var t=this.markers[0];console.log("removing ",this.markers,this.profile.user.trade_locations),t.setMap(null),this.markers.shift()},t.prototype.onPlaceChanged=function(t,e){var n=t.getPlace();n&&(console.log("place",n),n.geometry&&(e.panTo(n.geometry.location),e.setZoom(15)))},t.prototype.addMarker=function(t,e){void 0===e&&(e=null),console.log("111"),e=e||{remember:!0};var n=new google.maps.Marker({map:this.map,position:t,label:e.label,icon:e.icon});e.remember&&this.markers.push(n)},t.prototype.setMapOnAll=function(t){for(var e=0;e<this.markers.length;e++)this.markers[e].setMap(t)},t.prototype.clearMarkers=function(){this.setMapOnAll(null)},t.prototype.deleteMarkers=function(){this.clearMarkers(),this.markers=[]},c([Object(o._8)("map"),l("design:type",o.t)],t.prototype,"mapElement",void 0),t=c([Object(o.m)({selector:"page-map",template:'<ion-header class="ps4-header">\n\n  <ion-navbar>\n    <ion-title>Pick preferred trade locations</ion-title>\n  </ion-navbar>\n\n</ion-header>\n\n\n<ion-content class="ps4">\n\t<input id="autocomplete" class="display-none" type="text" [ngModel]="searchInput" (ionChange)="searchLocation">\n  <div #map id="map" style="height: 100%;"></div>\n\n  <ion-list class="trade-locations-container">\n  \t<h5 class="trade-location-header">Trade Locations</h5>\n  \t<ion-item class="trade-location" *ngFor="let tradeLocation of profile.user.trade_locations">\n  \t\t<h5>{{tradeLocation}}</h5>\n  \t</ion-item>\n  </ion-list>\n\n</ion-content>\n\n'}),l("design:paramtypes",[i.e,i.f,i.g,a.a,r.a,s.a])],t)}()},305:function(t,e,n){"use strict";n.d(e,"a",function(){return c});var o=n(0),i=n(23),r=n(47),a=this&&this.__decorate||function(t,e,n,o){var i,r=arguments.length,a=r<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(a=(r<3?i(a):r>3?i(e,n,a):i(e,n))||a);return r>3&&a&&Object.defineProperty(e,n,a),a},s=this&&this.__metadata||function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},c=function(){function t(t,e,n){this.navCtrl=t,this.navParams=e,this.auth=n}return t.prototype.ionViewDidLoad=function(){},t.prototype.logout=function(){this.auth.logout()},t=a([Object(o.m)({selector:"page-options",template:'\x3c!--\n  Generated template for the OptionsPage page.\n\n  See http://ionicframework.com/docs/components/#navigation for more info on\n  Ionic pages and navigation.\n--\x3e\n<ion-header>\n\n  <ion-navbar>\n    <ion-title>Options</ion-title>\n  </ion-navbar>\n\n</ion-header>\n\n\n<ion-content padding>\n  <ion-list inset>\n  \t<ion-item (click)="logout()">\n  \t\tLogout\n  \t</ion-item>\n\t</ion-list>\n</ion-content>\n'}),s("design:paramtypes",[i.e,i.f,r.a])],t)}()},306:function(t,e,n){"use strict";n.d(e,"a",function(){return d});var o=n(0),i=n(24),r=n(23),a=n(307),s=n(95),c=n(47),l=this&&this.__decorate||function(t,e,n,o){var i,r=arguments.length,a=r<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(a=(r<3?i(a):r>3?i(e,n,a):i(e,n))||a);return r>3&&a&&Object.defineProperty(e,n,a),a},u=this&&this.__metadata||function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},d=function(){function t(t,e,n){this.navCtrl=t,this.auth=e,this.loginForm=n.group({email:["",i.g.compose([i.g.required,i.g.email])],password:["",i.g.compose([i.g.required,i.g.minLength(6)])]})}return t.prototype.login=function(){var t=this,e=this.loginForm.value;if(e.email){this.auth.signInWithEmail({email:e.email,password:e.password}).then(function(){return t.navCtrl.setRoot(s.a)},function(e){return t.loginError=e.message})}},t.prototype.signup=function(){this.navCtrl.push(a.a)},t.prototype.loginWithGoogle=function(){var t=this;this.auth.logInWithGoogle().then(function(){return t.navCtrl.setRoot(s.a)},function(t){return console.log(t.message)})},t=l([Object(o.m)({selector:"page-login",template:'<ion-content padding>\n  <form [formGroup]="loginForm">\n      <ion-list inset>\n        <ion-item [ngClass]="{ invalid: emailErrors.hasError(\'*\', [\'touched\', \'dirty\']) }">\n          <ion-input type="text" placeholder="Email" formControlName="email"></ion-input>\n        </ion-item>\n\n        <div ngxErrors="email" #emailErrors="ngxErrors">\n          <div [ngxError]="[\'email\', \'required\']" [when]="[\'touched\', \'dirty\']">It should be a valid email</div>\n        </div>\n\n        <ion-item [ngClass]="{ invalid: passwordErrors.hasError(\'*\', [\'touched\']) }">\n          <ion-input type="password" placeholder="Password" formControlName="password"></ion-input>\n        </ion-item>\n\n        <div ngxErrors="password" #passwordErrors="ngxErrors">\n          <div [ngxError]="[\'minlength\', \'required\']" [when]="[\'touched\']">It should be at least 5 characters</div>\n        </div>\n      </ion-list>\n\n      <div padding-horizontal>\n        <div class="form-error">{{loginError}}</div>\n\n        <button ion-button full type="submit" [disabled]="!loginForm.valid" (click)="login()" >Log in</button>\n        <div class="login-footer">\n          <p>\n            <a href="#">Forgot password?</a>\n            If you\'re a new user, please sign up.\n          </p>\n        </div>\n      </div>\n\n        <ion-list>\n          <button ion-button icon-start block clear (click)="loginWithGoogle()">\n            <ion-icon name="logo-google"></ion-icon>\n            Log in with Google\n          </button>\n\n          <button ion-button icon-start block clear (click)="signup()">\n            <ion-icon name="person-add"></ion-icon>\n            Sign up\n          </button>\n        </ion-list>\n    </form>\n</ion-content>\n'}),u("design:paramtypes",[r.e,c.a,i.a])],t)}()},307:function(t,e,n){"use strict";n.d(e,"a",function(){return u});var o=n(0),i=n(23),r=n(24),a=n(47),s=n(95),c=this&&this.__decorate||function(t,e,n,o){var i,r=arguments.length,a=r<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(a=(r<3?i(a):r>3?i(e,n,a):i(e,n))||a);return r>3&&a&&Object.defineProperty(e,n,a),a},l=this&&this.__metadata||function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},u=function(){function t(t,e,n,o){this.navCtrl=t,this.navParams=e,this.auth=n,this.canSubmit=!1,this.validation_messages={first_name:[{type:"required",message:"first name is required."},{type:"minlength",message:"first name must be at least 3 characters long."},{type:"maxlength",message:"first name cannot be more than 20 characters long."},{type:"validUsername",message:"Your username has already been taken."}],last_name:[{type:"required",message:"last name is required."},{type:"minlength",message:"last name must be at least 3 characters long."},{type:"maxlength",message:"last name cannot be more than 20 characters long."},{type:"validUsername",message:"Your username has already been taken."}],email:[{type:"required",message:"email is required."},{type:"email",message:"must be a valid email."}],password:[{type:"required",message:"password is required."},{type:"pattern",message:"password must contain 1 upper case and 1 number."},{type:"minlength",message:"password must be at least 8 characters."}]},this.passwordType="password",this.showPasswordIcon="ios-eye-off";this.signupForm=o.group({first_name:["",r.g.compose([r.g.required,r.g.minLength(3),r.g.maxLength(20)])],last_name:["",r.g.compose([r.g.required,r.g.minLength(3),r.g.maxLength(20)])],email:["",r.g.compose([r.g.required,r.g.email])],password:["",r.g.compose([r.g.required,r.g.pattern("^(?=.*[a-z])(?=.*[A-Z])(?=.*[0-9])[a-zA-Z0-9]+$"),r.g.minLength(8),r.g.maxLength(20)])]})}return t.prototype.ionViewDidLoad=function(){},t.prototype.checkForm=function(){this.canSubmit=null==this.signupForm.errors},t.prototype.showPassword=function(){"password"==this.passwordType?(this.passwordType="text",this.showPasswordIcon="ios-eye"):(this.passwordType="password",this.showPasswordIcon="ios-eye-off")},t.prototype.signup=function(){var t=this;this.auth.signUp({firstName:this.signupForm.value.first_name,lastName:this.signupForm.value.last_name,email:this.signupForm.value.email,password:this.signupForm.value.password}).then(function(){return t.navCtrl.setRoot(s.a)},function(t){return console.log("signup error",t)})},t=c([Object(o.m)({selector:"page-signup",template:'<ion-header>\n  <ion-navbar>\n  </ion-navbar>\n</ion-header>\n\n\n<ion-content padding>\n  \n  <form (ngSubmit)="signup()" [formGroup]="signupForm" (change)="checkForm()">\n\n  \t\t<h2>Signup</h2>\n      <ion-list inset>\n\n        <ion-item style="margin-top: 20px;">\n          <ion-input type="text" placeholder="First Name" formControlName="first_name"></ion-input>\n        </ion-item>\n        \n        <div class="error-list" >\n        \t<div *ngFor="let validation of validation_messages.first_name" >\n\t        \t<h5 class="error-msg" *ngIf="signupForm.get(\'first_name\').hasError(validation.type) && (signupForm.get(\'first_name\').dirty || signupForm.get(\'first_name\').touched)" >\n\t        \t\t{{validation.message}}\n\t        \t</h5>\n        \t</div>\n        </div>\n\n        <ion-item style="margin-top: 20px;" >\n          <ion-input type="text" placeholder="Last Name" formControlName="last_name"></ion-input>\n        </ion-item>\n        \n        <div class="error-list" >\n        \t<div *ngFor="let validation of validation_messages.last_name" >\n\t        \t<h5 class="error-msg" *ngIf="signupForm.get(\'last_name\').hasError(validation.type) && (signupForm.get(\'last_name\').dirty || signupForm.get(\'last_name\').touched)" >\n\t        \t\t{{validation.message}}\n\t        \t</h5>\n        \t</div>\n        </div>\n\n        <ion-item >\n          <ion-input type="text" placeholder="Email" formControlName="email"></ion-input>\n        </ion-item>\n        \n        <div class="error-list" >\n        \t<div *ngFor="let validation of validation_messages.email" >\n\n\t        \t<h5 class="error-msg" *ngIf="signupForm.get(\'email\').hasError(\'required\') && \n\t        \t(signupForm.get(\'email\').dirty || signupForm.get(\'email\').touched) &&\n\t        \tvalidation.type == \'required\'\n\t        \t" >\n\t        \t\t{{validation.message}}\n\t        \t</h5>\n\t        \t<h5 class="error-msg" *ngIf="!signupForm.get(\'email\').hasError(\'required\') && signupForm.get(\'email\').hasError(validation.type) && (signupForm.get(\'email\').dirty || signupForm.get(\'email\').touched);" >\n\t        \t\t{{validation.message}}\n\t        \t</h5>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\n        <ion-item>\n          <ion-input type="{{passwordType}}" placeholder="Password" formControlName="password"></ion-input>\n        \t<ion-icon name="{{showPasswordIcon}}" (click)="showPassword()" item-right></ion-icon>\n        </ion-item>\n        \n        <div class="error-list" >\n        \t<div *ngFor="let validation of validation_messages.password" >\n\t        \t<h5 class="error-msg" *ngIf="signupForm.get(\'password\').hasError(validation.type) && (signupForm.get(\'password\').dirty || signupForm.get(\'password\').touched)" >\n\t        \t\t{{validation.message}}\n\t        \t</h5>\n        \t</div>\n        </div>\n\n      </ion-list>\n\n      <div class="btn-container">\n      \t<button ion-button type="submit" [disabled]="!signupForm.valid">Submit</button>\n      </div>\n\n\n    </form>\n\n</ion-content>\n'}),l("design:paramtypes",[i.e,i.f,a.a,r.a])],t)}()},310:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=n(311),i=n(433);Object(o.a)().bootstrapModule(i.a)},433:function(t,e,n){"use strict";n.d(e,"a",function(){return U});var o=n(0),i=n(53),r=n(23),a=n(473),s=n(281),c=n(283),l=n(157),u=n(284),d=n(300),f=n(515),p=n(296),h=n(297),m=n(298),g=n(95),v=n(306),y=n(307),b=n(305),_=n(162),w=n(304),P=n(47),O=n(94),R=n(93),j=n(299),L=n(37),T=n(161),k=n(48),I=n(528),C=n(72),x=n(532),A=n(533),F=n(301),E=this&&this.__decorate||function(t,e,n,o){var i,r=arguments.length,a=r<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(a=(r<3?i(a):r>3?i(e,n,a):i(e,n))||a);return r>3&&a&&Object.defineProperty(e,n,a),a},U=function(){function t(){}return t=E([Object(o.I)({declarations:[a.a,_.a,p.a,h.a,m.a,v.a,y.a,b.a,w.a,g.a],imports:[i.a,r.d.forRoot(a.a,{},{links:[]}),l.a.initializeApp(d.b.web),R.b,L.b,x.a,I.a,F.b.forRoot(),f.a],bootstrap:[r.b],entryComponents:[a.a,_.a,p.a,h.a,m.a,v.a,y.a,b.a,w.a,g.a],providers:[s.a,c.a,{provide:o.u,useClass:r.c},u.a,O.a,R.a,P.a,L.a,j.a,T.a,k.a,C.a,A.a]})],t)}()},47:function(t,e,n){"use strict";n.d(e,"a",function(){return d});var o=n(0),i=n(284),r=n(158),a=(n.n(r),n(288)),s=n(93),c=n(94),l=this&&this.__decorate||function(t,e,n,o){var i,r=arguments.length,a=r<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(a=(r<3?i(a):r>3?i(e,n,a):i(e,n))||a);return r>3&&a&&Object.defineProperty(e,n,a),a},u=this&&this.__metadata||function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},d=function(){function t(t,e,n){var o=this;this.afAuth=t,this.geolocation=e,this.afdb=n,t.authState.subscribe(function(t){console.log("user",t),o.user=t})}return t.prototype.signInWithEmail=function(t){return this.afAuth.auth.signInWithEmailAndPassword(t.email,t.password)},t.prototype.signUp=function(t){var e=this;return new Promise(function(n,o){e.afAuth.auth.createUserWithEmailAndPassword(t.email,t.password).then(function(i){var r=new a.a;r.first_name=t.firstName,r.last_name=t.lastName,r.email=t.email,e.geolocation.getCurrentPosition().then(function(t){r.last_location={lat:t.coords.latitude,long:t.coords.longitude},e.afdb.list("/users").push(r).then(function(t){e.afdb.list("/users").update(t.key,{key:t.key}),n()})}).catch(function(t){o(),console.log("Error getting location",t)})})})},Object.defineProperty(t.prototype,"authenticated",{get:function(){return null!==this.user},enumerable:!0,configurable:!0}),t.prototype.getEmail=function(){return this.user&&this.user.email},t.prototype.logout=function(){return this.user=null,this.afAuth.auth.signOut()},t.prototype.logInWithGoogle=function(){return this.afAuth.auth.signInWithPopup(new r.auth.GoogleAuthProvider)},t.prototype.logInWithGoogleRedirect=function(){var t=this;return this.afAuth.auth.signInWithRedirect(new r.auth.GoogleAuthProvider).then(function(){return t.afAuth.auth.getRedirectResult().then(function(t){var e=t.credential.accessToken,n=t.user;console.log(e,n)}).catch(function(t){alert(t.message)})})},t=l([Object(o.A)(),u("design:paramtypes",[i.a,c.a,s.a])],t)}()},473:function(t,e,n){"use strict";n.d(e,"a",function(){return y});var o=n(0),i=n(23),r=n(281),a=n(283),s=n(47),c=n(93),l=n(16),u=n(48),d=n(94),f=n(161),p=n(95),h=n(306),m=this&&this.__assign||Object.assign||function(t){for(var e,n=1,o=arguments.length;n<o;n++){e=arguments[n];for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])}return t},g=this&&this.__decorate||function(t,e,n,o){var i,r=arguments.length,a=r<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(a=(r<3?i(a):r>3?i(e,n,a):i(e,n))||a);return r>3&&a&&Object.defineProperty(e,n,a),a},v=this&&this.__metadata||function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},y=function(){function t(t,e,n,o,i,r,a,s){var c=this;this.platform=t,this.statusBar=e,this.splashScreen=n,this.afdb=o,this.auth=i,this.profile=r,this.geolocation=a,this.trade=s,this.rootPage=null,t.ready().then(function(){e.styleDefault(),n.hide(),i.afAuth.authState.subscribe(function(t){if(console.log("app component subscription"),t){c.rootPage=p.a;c.initProfile(t).then(function(e){return c.initTrades(t)})}else c.rootPage=h.a},function(){c.rootPage=h.a})})}return t.prototype.initTrades=function(t){this.trade.getNearestPossibleTrades(this.profile.user.key)},t.prototype.initProfile=function(t){var e=this;return new Promise(function(n,o){var i=e.afdb.list("/users",function(e){return e.orderByChild("email").equalTo(t.email)}),r=i.snapshotChanges().pipe(Object(l.map)(function(t){return t.map(function(t){return m({key:t.payload.key},t.payload.val())})})).subscribe(function(t){t[0]&&t[0].key&&(console.log("fb user",t),e.profile.user.profileImage=t[0].profile_image||"assets/imgs/temp_profile_img_1.png",e.profile.user.name=t[0].first_name+" "+t[0].last_name,e.profile.user.first_name=t[0].first_name||"",e.profile.user.last_name=t[0].last_name||"",e.profile.user.email=t[0].email||"",e.profile.user.wishList=t[0].wishList||[],e.profile.user.ownedList=t[0].ownedList||[],e.profile.user.key=t[0].key||"",e.profile.user.conversations=t[0].conversations||[],e.profile.user.trade_locations=t[0].trade_locations||[],console.log(">>geolocation ",e.profile.user),e.geolocation.getCurrentPosition({timeout:2e4,enableHighAccuracy:!0}).then(function(o){i.update(t[0].key,{last_location:{lat:o.coords.latitude,long:o.coords.longitude}}).then(function(t){n()}),console.log(">>user from component ",e.profile.user),r.unsubscribe()}).catch(function(t){o(console.log(">>Error getting location",t))}))})})},t=g([Object(o.m)({template:'<ion-nav [root]="rootPage"></ion-nav>\n'}),v("design:paramtypes",[i.g,r.a,a.a,c.a,s.a,u.a,d.a,f.a])],t)}()},48:function(t,e,n){"use strict";n.d(e,"a",function(){return u});var o=n(37),i=n(0),r=n(288),a=n(506),s=(n.n(a),n(72)),c=this&&this.__decorate||function(t,e,n,o){var i,r=arguments.length,a=r<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(a=(r<3?i(a):r>3?i(e,n,a):i(e,n))||a);return r>3&&a&&Object.defineProperty(e,n,a),a},l=this&&this.__metadata||function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},u=function(){function t(t,e){this.http=t,this.fbapp=e,this.allListsUpdateTimeout=null,this.wishListUpdateTimeout=null,this.ownedListUpdateTimeout=null,this.user=new r.a}return t.prototype.addGameToProfile=function(t,e,n){var o=a.find(this.user.wishList,function(t){return t.id===e.id});e.platforms||(e.platforms=[]),console.log("addGamToProfile: ",e),o?(this.user.ownedList.push(e),this.fbapp.updateUserOwnedList(t,this.user.ownedList)):(this.user.wishList.push(e),this.fbapp.updateUserWishList(t,this.user.wishList))},t.prototype.toggleItemOwnership=function(t,e,n){if(n){if(a.find(this.user.wishList,function(t){return t.id===e.id}))return;this.user.wishList.push(e),this.user.ownedList=a.reject(this.user.ownedList,function(t){return t.id===e.id})}else{if(a.find(this.user.ownedList,function(t){return t.id===e.id}))return;this.user.ownedList.push(e),this.user.wishList=a.reject(this.user.wishList,function(t){return t.id===e.id})}this.startAllListsUpdateTImer(t)},t.prototype.toggleItemPlatform=function(t,e,n,o){a.contains(e.platforms,n)?e.platforms=a.reject(e.platforms,function(t){return t===n}):e.platforms.push(n),o?this.startWishListUpdateTImer(t):this.startOwnedListUpdateTImer(t)},t.prototype.removeItem=function(t,e,n){n?(this.user.ownedList=a.reject(this.user.ownedList,function(t){return t.id===e.id}),this.startOwnedListUpdateTImer(t)):(this.user.wishList=a.reject(this.user.wishList,function(t){return t.id===e.id}),this.startWishListUpdateTImer(t))},t.prototype.isItemMatch=function(t){for(var e=0,n=this.user.wishList;e<n.length;e++){if(n[e].id===t.id)return!0}return!1},t.prototype.startAllListsUpdateTImer=function(t){clearTimeout(this.allListsUpdateTimeout);var e=this;this.allListsUpdateTimeout=setTimeout(function(){e.fbapp.updateUserWishList(t,e.user.wishList),e.fbapp.updateUserOwnedList(t,e.user.ownedList)},1e3)},t.prototype.startWishListUpdateTImer=function(t){clearTimeout(this.wishListUpdateTimeout);var e=this;this.wishListUpdateTimeout=setTimeout(function(){e.fbapp.updateUserWishList(t,e.user.wishList)},1e3)},t.prototype.startOwnedListUpdateTImer=function(t){clearTimeout(this.ownedListUpdateTimeout);var e=this;this.ownedListUpdateTimeout=setTimeout(function(){e.fbapp.updateUserOwnedList(t,e.user.ownedList)},1e3)},t=c([Object(i.A)(),l("design:paramtypes",[o.a,s.a])],t)}()},508:function(t,e,n){"use strict";n.d(e,"a",function(){return o});var o=function(){return function(t,e,n,o){this.text="",this.sender="",this.senderKey="",this.text=t,this.sender=e,this.senderKey=n,this.createdAt=o}}()},509:function(t,e,n){"use strict";n.d(e,"a",function(){return o});var o=function(){return function(t,e,n){this.key="",this.traderKey="",this.name="",this.key=t,this.traderKey=e,this.name=n}}()},510:function(t,e,n){"use strict";n.d(e,"a",function(){return o});var o=function(){return function(t,e,n,o){void 0===t&&(t=null),void 0===e&&(e=null),void 0===n&&(n=null),void 0===o&&(o=null),this.id=t,this.name=e,this.cover_url=n,this.platforms=o}}()},528:function(t,e,n){"use strict";n.d(e,"a",function(){return c});var o=n(0),i=n(529),r=n(530),a=n(531),s=this&&this.__decorate||function(t,e,n,o){var i,r=arguments.length,a=r<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(a=(r<3?i(a):r>3?i(e,n,a):i(e,n))||a);return r>3&&a&&Object.defineProperty(e,n,a),a},c=function(){function t(){}return t=s([Object(o.I)({declarations:[i.a,r.a,a.a],imports:[],exports:[i.a,r.a,a.a]})],t)}()},529:function(t,e,n){"use strict";n.d(e,"a",function(){return r});var o=n(0),i=this&&this.__decorate||function(t,e,n,o){var i,r=arguments.length,a=r<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(a=(r<3?i(a):r>3?i(e,n,a):i(e,n))||a);return r>3&&a&&Object.defineProperty(e,n,a),a},r=function(){function t(){}return t.prototype.transform=function(t,e){var n=[];for(var o in t)n.push(t);return n},t=i([Object(o.S)({name:"keys"})],t)}()},530:function(t,e,n){"use strict";n.d(e,"a",function(){return r});var o=n(0),i=this&&this.__decorate||function(t,e,n,o){var i,r=arguments.length,a=r<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(a=(r<3?i(a):r>3?i(e,n,a):i(e,n))||a);return r>3&&a&&Object.defineProperty(e,n,a),a},r=function(){function t(){}return t.prototype.transform=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];return t.replace(e[0],e[1])},t=i([Object(o.S)({name:"replace"})],t)}()},531:function(t,e,n){"use strict";n.d(e,"a",function(){return r});var o=n(0),i=this&&this.__decorate||function(t,e,n,o){var i,r=arguments.length,a=r<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(a=(r<3?i(a):r>3?i(e,n,a):i(e,n))||a);return r>3&&a&&Object.defineProperty(e,n,a),a},r=function(){function t(){}return t.prototype.transform=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];return Math.ceil(parseFloat(t))},t=i([Object(o.S)({name:"ceil"})],t)}()},533:function(t,e,n){"use strict";n.d(e,"a",function(){return s});var o=n(37),i=n(0),r=this&&this.__decorate||function(t,e,n,o){var i,r=arguments.length,a=r<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(a=(r<3?i(a):r>3?i(e,n,a):i(e,n))||a);return r>3&&a&&Object.defineProperty(e,n,a),a},a=this&&this.__metadata||function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},s=function(){function t(t){this.http=t,console.log("Hello UiProvider Provider")}return t.prototype.getRandomProfileImage=function(){return 0},t.prototype.getRandomInt=function(t,e){return Math.floor(Math.random()*(e-t+1))+t},t=r([Object(i.A)(),a("design:paramtypes",[o.a])],t)}()},72:function(t,e,n){"use strict";n.d(e,"a",function(){return p});var o=n(37),i=n(0),r=n(16),a=n(508),s=n(509),c=n(158),l=(n.n(c),n(93)),u=this&&this.__assign||Object.assign||function(t){for(var e,n=1,o=arguments.length;n<o;n++){e=arguments[n];for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])}return t},d=this&&this.__decorate||function(t,e,n,o){var i,r=arguments.length,a=r<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(a=(r<3?i(a):r>3?i(e,n,a):i(e,n))||a);return r>3&&a&&Object.defineProperty(e,n,a),a},f=this&&this.__metadata||function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},p=function(){function t(t,e){this.http=t,this.afdb=e,console.log("Hello FirebaseappProvider Provider")}return t.prototype.updateUserTradeLocations=function(t,e){this.afdb.list("/users/"+t+"/").set("trade_locations",e)},t.prototype.updateUserWishList=function(t,e){var n=this.afdb.list("/users",function(e){return e.orderByChild("email").equalTo(t.email)}),o=n.snapshotChanges().pipe(Object(r.map)(function(t){return t.map(function(t){return u({key:t.payload.key},t.payload.val())})})).subscribe(function(t){if(console.log("get user data",t),t[0]){var i=t[0].key;console.log("adding to wishlist["+i+"]",e),n.update(i,{wishList:e}),o.unsubscribe()}})},t.prototype.updateUserOwnedList=function(t,e){var n=this.afdb.list("/users",function(e){return e.orderByChild("email").equalTo(t.email)}),o=n.snapshotChanges().pipe(Object(r.map)(function(t){return t.map(function(t){return u({key:t.payload.key},t.payload.val())})})).subscribe(function(t){if(console.log("get user data",t),t[0]){var i=t[0].key;console.log("adding to owned["+i+"]",e),n.update(i,{ownedList:e}),o.unsubscribe()}})},t.prototype.getConversationMessages=function(t){return this.afdb.list("/conversations/"+t+"/messages/").valueChanges(["child_added"])},t.prototype.getTraderConversationKey=function(t,e){console.log("-fbapp getTraderConversationKey: ",t.conversations,e.conversations);if(t.conversations&&e.conversations){for(var n in e.conversations)for(var o in t.conversations)if(t.conversations[o].key===e.conversations[n].key)return e.conversations[n].key;return null}console.log("r")},t.prototype.createNewThread=function(t,e,n){console.log("push convo "+n,t,e);var o={};o[t.key]=!0,o[e.key]=!0;var i=new a.a(n,e.name,e.key,c.database.ServerValue.TIMESTAMP),r=this.pushConversation([i],o);e.conversations=e.conversations?e.conversations:[];var l=new s.a(r.key,t.key,t.first_name+" "+t.last_name);e.conversations[r.key]=l,console.log("uckey:",e.conversations),this.updateUserConversation(e.key,r.key,l),t.conversations=t.conversations?t.conversations:[];var u=new s.a(r.key,e.key,e.first_name+" "+e.last_name);t.conversations[r.key]=u;this.afdb.list("/users/"+t.key+"/conversations/").update(r.key,u);return r},t.prototype.updateUserConversation=function(t,e,n){return this.afdb.list("/users/"+t+"/conversations/").update(e,n)},t.prototype.pushConversation=function(t,e){return this.afdb.list("/conversations").push({messages:t,members:e})},t.prototype.updateConversation=function(t,e,n,o){var i=this;console.log("update convo "+t);var r=this.afdb.object("/conversations/"+t).snapshotChanges().subscribe(function(e){try{var s=e.payload.val();if(!s)return;s.messages=s.messages||[];var l=new a.a(o,n.name,n.key,c.database.ServerValue.TIMESTAMP);s.messages.push(l),i.afdb.list("/conversations").update(t,{messages:s.messages}),console.log("converRef update: ",e.payload.val()),r.unsubscribe()}catch(t){console.log("Error updating conversation ",t)}})},t.prototype.getUserConversations=function(t){return this.afdb.object("/users/"+t.key+"/conversations/").snapshotChanges()},t.prototype.getMessages=function(t){var e=this.getUserConversations(t).subscribe(function(t){t.payload.val(),e.unsubscribe()})},t.prototype.getProfile=function(t){var e=this;return new Promise(function(n,o){var i=e.afdb.object("/users/"+t).snapshotChanges().subscribe(function(t){n(t.payload.val()),i.unsubscribe()})})},t=d([Object(i.A)(),f("design:paramtypes",[o.a,l.a])],t)}()},95:function(t,e,n){"use strict";n.d(e,"a",function(){return d});var o=n(0),i=n(23),r=n(296),a=n(297),s=n(298),c=n(305),l=this&&this.__decorate||function(t,e,n,o){var i,r=arguments.length,a=r<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(a=(r<3?i(a):r>3?i(e,n,a):i(e,n))||a);return r>3&&a&&Object.defineProperty(e,n,a),a},u=this&&this.__metadata||function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},d=function(){function t(t){this.navCtrl=t,this.tab1Root=s.a,this.tab2Root=r.a,this.tab3Root=a.a}return t.prototype.navTo=function(t){this.navCtrl.push(c.a,{},{animate:!0,direction:"forward"})},t=l([Object(o.m)({selector:"page-tabs",template:'<ion-header class="ps4-header">\n  <ion-navbar>\n    <ion-title></ion-title>\n\n    <ion-icon class="settings" name="settings" (click)="navTo(\'options\')"></ion-icon>\n   \n  </ion-navbar>\n</ion-header>\n\n<ion-tabs tabsPlacement="bottom" selectedIndex="0">\n  <ion-tab [root]="tab1Root" tabTitle="Profile" tabIcon="contact"></ion-tab>\n  <ion-tab [root]="tab2Root" tabTitle="Trade" tabIcon="contacts"></ion-tab>\n  <ion-tab [root]="tab3Root" tabTitle="Messages" tabIcon="chatbubbles"></ion-tab>\n</ion-tabs>\n\n'}),u("design:paramtypes",[i.e])],t)}()}},[310]);